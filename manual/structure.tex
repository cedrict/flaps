
\begin{verbatim}
read input parameters
read planet data
quadrature setup
make Q2 (V) and Q1 (P) mesh (coords+icon)
flag boundary nodes & elts
compute normal vectors
define boundary conditions
build arrays for fast assembly
          |
--------------------------------------- time
|         |                           | stepping
| compute mapping                     |
| compute elt center coords           |
| compute rho and eta in elts         |
| sanity check                        |
| build FE matrix                     |
| solve linear system                 |
| split solution                      |
| compute strain rate                 |
| project Q1 pressure on Q2 mesh      |
| convert strain rate to sph. coords. |
| normalise pressure                  |
| compute dyn. topography             |
| export results on boundaries        |
| compute L2 error                    |
| compute g inside (optional)         |
| export solution to vtu              |
| compute gravity outside (opt)       |
| mesh advection                      |
|         |                           |
---------------------------------------
          | 
\end{verbatim}

