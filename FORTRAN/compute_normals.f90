!==================================================================================================!
!==================================================================================================!
!                                                                                                  !
! FLAPS                                                                                            !
!                                                                                                  !
!==================================================================================================!
!==================================================================================================!

subroutine compute_normals

use iso_fortran_env
use module_parameters
use module_mesh 
!use module_constants
!use module_arrays
use module_timing

implicit none

integer(int32):: i

!==================================================================================================!
!==================================================================================================!
!@@ \subsection{compute\_normals}
!@@
!==================================================================================================!

call tic() 

!==============================================================================!

do iel=1,nel
   do i=1,mV
      if (mesh(iel)%surfaceV(i)) then
         mesh(iel)%nx(i)=cos(mesh(iel)%thetaV(i))
         mesh(iel)%nz(i)=sin(mesh(iel)%thetaV(i))
      end if
      if (mesh(iel)%cmbV(i)) then
         mesh(iel)%nx(i)=-cos(mesh(iel)%thetaV(i))
         mesh(iel)%nz(i)=-sin(mesh(iel)%thetaV(i))
      end if
   end do
end do

!==============================================================================!

call toc('_____compute_normals')

end subroutine

!==================================================================================================!
!==================================================================================================!
