!==================================================================================================!
!==================================================================================================!
!                                                                                                  !
! FLAPS                                                                                            !
!                                                                                                  !
!==================================================================================================!
!==================================================================================================!

subroutine setup_matrix_K

use iso_fortran_env
use module_core
use module_parameters,only: NfemV,NV
use module_sparse,only: csrK
use module_timing

implicit none

integer(int32):: ip,jp,i,j,k,i1,i2,j1,j2,k1,k2,nsees,nz,nnx,nny,nnz
integer(int32):: NU,NW
logical, dimension(:), allocatable :: alreadyseen

!==================================================================================================!
!==================================================================================================!
!@@ \subsection{setup\_A}
!@@ Matrix A is the assembled FE matrix.
!@@ If the geometry is {\tt 'box'} or {\tt 'chunk'} the number of nonzeros in the matrix and 
!@@ its sparsity  structure are computed in a very efficient way. 
!==================================================================================================!

call tic() 

!==============================================================================!

csrK%N=NfemV

write(*,'(a,i11,a)') shift//'csrK%N       =',csrK%N,' '

!----------------------------------------------------------
! compute NZ
!----------------------------------------------------------

call cpu_time(t3)
allocate(alreadyseen(2*NV))
NZ=0
















call toc('______setup_matrix_K')

end subroutine

!==================================================================================================!
!==================================================================================================!
